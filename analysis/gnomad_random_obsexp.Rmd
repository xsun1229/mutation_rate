---
title: "Random effect modelling"
author: "XSun"
date: "2023-04-04"
output: workflowr::wflow_html
editor_options:
  chunk_output_type: console
---

```{r echo=FALSE, message=FALSE, warning=FALSE}
library(data.table)
suppressMessages(library(smashr))
```

# Introduction

In this part, the chr22 was grouped into 100bp windows. We evalueate the random effects on these 100bp windows.


# Modelling the allele count

## All 6 mutation types in total

```{r echo=FALSE, message=FALSE, warning=FALSE}
merged <- fread("/project/xinhe/xsun/mutation_rate/1.exp_obs_gnomad/results/chr22_grouped_rescale.bed")
colnames(merged) <- c("chr","start","end", "MR_exp","AC_obs")

print("random effect: ac_obs/ac_exp")

eff_rand <- merged$AC_obs/merged$MR_exp
eff_rand <- eff_rand[!is.na(eff_rand)]
hist(eff_rand)

print("gauss")
mu.e <- smash.gaus(as.numeric(eff_rand))
plot(sum_mut$V5, type="l")
lines(mu.e2,col="2")


plot(eff_rand)


```


```{r}

```

