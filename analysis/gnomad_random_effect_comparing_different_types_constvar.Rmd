---
title: "Comparing random effects (SMASH estimated) for different mutation types (constant variance)"
author: "XSun"
date: "2023-04-07"
output: workflowr::wflow_html
editor_options:
  chunk_output_type: console
---

```{r echo=FALSE, message=FALSE, warning=FALSE}
suppressMessages(library(ggplot2))
suppressMessages(library(gridExtra))
```

# Introduction

An interesting question is whether the hot-spots of different mutation types tend to occur together. To make comparison: 

1. we created plots with the Smash estimates of multiple mutation types together in few regions. 

2. we made a scatter plot of the Smash estimates of the random effects between two mutation types across all windows. 

# Comparing Smash estimates of multiple mutation types together in few regions. --- total mutation included


## 1kb

```{r echo=FALSE, message=FALSE, warning=FALSE,fig.height=6, fig.width=10}

dat_all <- get(load("/project/xinhe/xsun/mutation_rate/1.exp_obs_gnomad/data_processed/chr22/smash_1kb_pseudo05_wholewindow_constvar.rdata"))
dat_all$mb <- dat_all$start/1000000
dat_ac <- get(load("/project/xinhe/xsun/mutation_rate/1.exp_obs_gnomad/data_processed/chr22/smash_1kb_pseudo05_wholewindow_ac_constvar.rdata"))
dat_ac$mb <- dat_ac$start/1000000
dat_at <- get(load("/project/xinhe/xsun/mutation_rate/1.exp_obs_gnomad/data_processed/chr22/smash_1kb_pseudo05_wholewindow_at_constvar.rdata"))
dat_at$mb <- dat_at$start/1000000
dat_ag <- get(load("/project/xinhe/xsun/mutation_rate/1.exp_obs_gnomad/data_processed/chr22/smash_1kb_pseudo05_wholewindow_ag_constvar.rdata"))
dat_ag$mb <- dat_ag$start/1000000
dat_ca <- get(load("/project/xinhe/xsun/mutation_rate/1.exp_obs_gnomad/data_processed/chr22/smash_1kb_pseudo05_wholewindow_ca_constvar.rdata"))
dat_ca$mb <- dat_ca$start/1000000
dat_cg <- get(load("/project/xinhe/xsun/mutation_rate/1.exp_obs_gnomad/data_processed/chr22/smash_1kb_pseudo05_wholewindow_cg_constvar.rdata"))
dat_cg$mb <- dat_cg$start/1000000
dat_ct <- get(load("/project/xinhe/xsun/mutation_rate/1.exp_obs_gnomad/data_processed/chr22/smash_1kb_pseudo05_wholewindow_ct_constvar.rdata"))
dat_ct$mb <- dat_ct$start/1000000


print("9Mb")
dat_all <- dat_all[dat_all$mb >31 &dat_all$mb <40, ]
dat_ac <- dat_ac[dat_ac$mb >31 &dat_ac$mb <40, ]
dat_at <- dat_at[dat_at$mb >31 &dat_at$mb <40, ]
dat_ag <- dat_ag[dat_ag$mb >31 &dat_ag$mb <40, ]
dat_ca <- dat_ca[dat_ca$mb >31 &dat_ca$mb <40, ]
dat_cg <- dat_cg[dat_cg$mb >31 &dat_cg$mb <40, ]
dat_ct <- dat_ct[dat_ct$mb >31 &dat_ct$mb <40, ]


dat_list <- list(dat_all, dat_ac, dat_at, dat_ag, dat_ca, dat_ct, dat_cg)
dat <- do.call(rbind, dat_list)
group <- rep(1:length(dat_list), sapply(dat_list, nrow))
dat$group <- factor(group)

colors <- c("red", "blue", "green", "purple", "orange", "pink", "brown")

p <- ggplot(dat, aes(x = mb, y = randeff_sm, color = group)) + 
  geom_line(alpha=0.5) +
  labs(x = "Gemonic position", y = "Random Effect -- SMASH", title = "Comparison for different mutation types" ) + 
  scale_color_manual(values = colors,labels = c("All", "A-C", "A-T", "A-G", "C-A", "C-T", "C-G")) +
  theme_bw() + 
  theme(plot.title = element_text(hjust = 0.5))

p


print("5Mb")
dat_all <- dat_all[dat_all$mb >31 &dat_all$mb <36, ]
dat_ac <- dat_ac[dat_ac$mb >31 &dat_ac$mb <36, ]
dat_at <- dat_at[dat_at$mb >31 &dat_at$mb <36, ]
dat_ag <- dat_ag[dat_ag$mb >31 &dat_ag$mb <36, ]
dat_ca <- dat_ca[dat_ca$mb >31 &dat_ca$mb <36, ]
dat_cg <- dat_cg[dat_cg$mb >31 &dat_cg$mb <36, ]
dat_ct <- dat_ct[dat_ct$mb >31 &dat_ct$mb <36, ]


dat_list <- list(dat_all, dat_ac, dat_at, dat_ag, dat_ca, dat_ct, dat_cg)
dat <- do.call(rbind, dat_list)
group <- rep(1:length(dat_list), sapply(dat_list, nrow))
dat$group <- factor(group)

colors <- c("red", "blue", "green", "purple", "orange", "pink", "brown")

p <- ggplot(dat, aes(x = mb, y = randeff_sm, color = group)) + 
  geom_line(alpha=0.5) +
  labs(x = "Gemonic position", y = "Random Effect -- SMASH", title = "Comparison for different mutation types" ) + 
  scale_color_manual(values = colors,labels = c("All", "A-C", "A-T", "A-G", "C-A", "C-T", "C-G")) +
  theme_bw() + 
  theme(plot.title = element_text(hjust = 0.5))

p


print("1Mb")
dat_all <- dat_all[dat_all$mb >31 &dat_all$mb <32, ]
dat_ac <- dat_ac[dat_ac$mb >31 &dat_ac$mb <32, ]
dat_at <- dat_at[dat_at$mb >31 &dat_at$mb <32, ]
dat_ag <- dat_ag[dat_ag$mb >31 &dat_ag$mb <32, ]
dat_ca <- dat_ca[dat_ca$mb >31 &dat_ca$mb <32, ]
dat_cg <- dat_cg[dat_cg$mb >31 &dat_cg$mb <32, ]
dat_ct <- dat_ct[dat_ct$mb >31 &dat_ct$mb <32, ]


dat_list <- list(dat_all, dat_ac, dat_at, dat_ag, dat_ca, dat_ct, dat_cg)
dat <- do.call(rbind, dat_list)
group <- rep(1:length(dat_list), sapply(dat_list, nrow))
dat$group <- factor(group)

colors <- c("red", "blue", "green", "purple", "orange", "pink", "brown")

p <- ggplot(dat, aes(x = mb, y = randeff_sm, color = group)) + 
  geom_line(alpha=0.5) +
  labs(x = "Gemonic position", y = "Random Effect -- SMASH", title = "Comparison for different mutation types" ) + 
  scale_color_manual(values = colors,labels = c("All", "A-C", "A-T", "A-G", "C-A", "C-T", "C-G")) +
  theme_bw() + 
  theme(plot.title = element_text(hjust = 0.5))

p

print("0.5Mb")
dat_all <- dat_all[dat_all$mb >31 &dat_all$mb <31.5, ]
dat_ac <- dat_ac[dat_ac$mb >31 &dat_ac$mb <31.5, ]
dat_at <- dat_at[dat_at$mb >31 &dat_at$mb <31.5, ]
dat_ag <- dat_ag[dat_ag$mb >31 &dat_ag$mb <31.5, ]
dat_ca <- dat_ca[dat_ca$mb >31 &dat_ca$mb <31.5, ]
dat_cg <- dat_cg[dat_cg$mb >31 &dat_cg$mb <31.5, ]
dat_ct <- dat_ct[dat_ct$mb >31 &dat_ct$mb <31.5, ]


dat_list <- list(dat_all, dat_ac, dat_at, dat_ag, dat_ca, dat_ct, dat_cg)
dat <- do.call(rbind, dat_list)
group <- rep(1:length(dat_list), sapply(dat_list, nrow))
dat$group <- factor(group)

colors <- c("red", "blue", "green", "purple", "orange", "pink", "brown")

p <- ggplot(dat, aes(x = mb, y = randeff_sm, color = group)) + 
  geom_line(alpha=0.5) +
  labs(x = "Gemonic position", y = "Random Effect -- SMASH", title = "Comparison for different mutation types" ) + 
  scale_color_manual(values = colors,labels = c("All", "A-C", "A-T", "A-G", "C-A", "C-T", "C-G")) +
  theme_bw() + 
  theme(plot.title = element_text(hjust = 0.5))

p

```


## 10kb

```{r echo=FALSE, message=FALSE, warning=FALSE,fig.height=6, fig.width=10}

dat_all <- get(load("/project/xinhe/xsun/mutation_rate/1.exp_obs_gnomad/data_processed/chr22/smash_10kb_pseudo05_wholewindow_constvar.rdata"))
dat_all$mb <- dat_all$start/1000000
dat_ac <- get(load("/project/xinhe/xsun/mutation_rate/1.exp_obs_gnomad/data_processed/chr22/smash_10kb_pseudo05_wholewindow_ac_constvar.rdata"))
dat_ac$mb <- dat_ac$start/1000000
dat_at <- get(load("/project/xinhe/xsun/mutation_rate/1.exp_obs_gnomad/data_processed/chr22/smash_10kb_pseudo05_wholewindow_at_constvar.rdata"))
dat_at$mb <- dat_at$start/1000000
dat_ag <- get(load("/project/xinhe/xsun/mutation_rate/1.exp_obs_gnomad/data_processed/chr22/smash_10kb_pseudo05_wholewindow_ag_constvar.rdata"))
dat_ag$mb <- dat_ag$start/1000000
dat_ca <- get(load("/project/xinhe/xsun/mutation_rate/1.exp_obs_gnomad/data_processed/chr22/smash_10kb_pseudo05_wholewindow_ca_constvar.rdata"))
dat_ca$mb <- dat_ca$start/1000000
dat_cg <- get(load("/project/xinhe/xsun/mutation_rate/1.exp_obs_gnomad/data_processed/chr22/smash_10kb_pseudo05_wholewindow_cg_constvar.rdata"))
dat_cg$mb <- dat_cg$start/1000000
dat_ct <- get(load("/project/xinhe/xsun/mutation_rate/1.exp_obs_gnomad/data_processed/chr22/smash_10kb_pseudo05_wholewindow_ct_constvar.rdata"))
dat_ct$mb <- dat_ct$start/1000000


print("9Mb")
dat_all <- dat_all[dat_all$mb >31 &dat_all$mb <40, ]
dat_ac <- dat_ac[dat_ac$mb >31 &dat_ac$mb <40, ]
dat_at <- dat_at[dat_at$mb >31 &dat_at$mb <40, ]
dat_ag <- dat_ag[dat_ag$mb >31 &dat_ag$mb <40, ]
dat_ca <- dat_ca[dat_ca$mb >31 &dat_ca$mb <40, ]
dat_cg <- dat_cg[dat_cg$mb >31 &dat_cg$mb <40, ]
dat_ct <- dat_ct[dat_ct$mb >31 &dat_ct$mb <40, ]


dat_list <- list(dat_all, dat_ac, dat_at, dat_ag, dat_ca, dat_ct, dat_cg)
dat <- do.call(rbind, dat_list)
group <- rep(1:length(dat_list), sapply(dat_list, nrow))
dat$group <- factor(group)

colors <- c("red", "blue", "green", "purple", "orange", "pink", "brown")

p <- ggplot(dat, aes(x = mb, y = randeff_sm, color = group)) + 
  geom_line(alpha=0.5) +
  labs(x = "Gemonic position", y = "Random Effect -- SMASH", title = "Comparison for different mutation types" ) + 
  scale_color_manual(values = colors,labels = c("All", "A-C", "A-T", "A-G", "C-A", "C-T", "C-G")) +
  theme_bw() + 
  theme(plot.title = element_text(hjust = 0.5))

p


print("5Mb")
dat_all <- dat_all[dat_all$mb >31 &dat_all$mb <36, ]
dat_ac <- dat_ac[dat_ac$mb >31 &dat_ac$mb <36, ]
dat_at <- dat_at[dat_at$mb >31 &dat_at$mb <36, ]
dat_ag <- dat_ag[dat_ag$mb >31 &dat_ag$mb <36, ]
dat_ca <- dat_ca[dat_ca$mb >31 &dat_ca$mb <36, ]
dat_cg <- dat_cg[dat_cg$mb >31 &dat_cg$mb <36, ]
dat_ct <- dat_ct[dat_ct$mb >31 &dat_ct$mb <36, ]


dat_list <- list(dat_all, dat_ac, dat_at, dat_ag, dat_ca, dat_ct, dat_cg)
dat <- do.call(rbind, dat_list)
group <- rep(1:length(dat_list), sapply(dat_list, nrow))
dat$group <- factor(group)

colors <- c("red", "blue", "green", "purple", "orange", "pink", "brown")

p <- ggplot(dat, aes(x = mb, y = randeff_sm, color = group)) + 
  geom_line(alpha=0.5) +
  labs(x = "Gemonic position", y = "Random Effect -- SMASH", title = "Comparison for different mutation types" ) + 
  scale_color_manual(values = colors,labels = c("All", "A-C", "A-T", "A-G", "C-A", "C-T", "C-G")) +
  theme_bw() + 
  theme(plot.title = element_text(hjust = 0.5))

p


print("1Mb")
dat_all <- dat_all[dat_all$mb >31 &dat_all$mb <32, ]
dat_ac <- dat_ac[dat_ac$mb >31 &dat_ac$mb <32, ]
dat_at <- dat_at[dat_at$mb >31 &dat_at$mb <32, ]
dat_ag <- dat_ag[dat_ag$mb >31 &dat_ag$mb <32, ]
dat_ca <- dat_ca[dat_ca$mb >31 &dat_ca$mb <32, ]
dat_cg <- dat_cg[dat_cg$mb >31 &dat_cg$mb <32, ]
dat_ct <- dat_ct[dat_ct$mb >31 &dat_ct$mb <32, ]


dat_list <- list(dat_all, dat_ac, dat_at, dat_ag, dat_ca, dat_ct, dat_cg)
dat <- do.call(rbind, dat_list)
group <- rep(1:length(dat_list), sapply(dat_list, nrow))
dat$group <- factor(group)

colors <- c("red", "blue", "green", "purple", "orange", "pink", "brown")

p <- ggplot(dat, aes(x = mb, y = randeff_sm, color = group)) + 
  geom_line(alpha=0.5) +
  labs(x = "Gemonic position", y = "Random Effect -- SMASH", title = "Comparison for different mutation types" ) + 
  scale_color_manual(values = colors,labels = c("All", "A-C", "A-T", "A-G", "C-A", "C-T", "C-G")) +
  theme_bw() + 
  theme(plot.title = element_text(hjust = 0.5))

p

print("0.5Mb")
dat_all <- dat_all[dat_all$mb >31 &dat_all$mb <31.5, ]
dat_ac <- dat_ac[dat_ac$mb >31 &dat_ac$mb <31.5, ]
dat_at <- dat_at[dat_at$mb >31 &dat_at$mb <31.5, ]
dat_ag <- dat_ag[dat_ag$mb >31 &dat_ag$mb <31.5, ]
dat_ca <- dat_ca[dat_ca$mb >31 &dat_ca$mb <31.5, ]
dat_cg <- dat_cg[dat_cg$mb >31 &dat_cg$mb <31.5, ]
dat_ct <- dat_ct[dat_ct$mb >31 &dat_ct$mb <31.5, ]


dat_list <- list(dat_all, dat_ac, dat_at, dat_ag, dat_ca, dat_ct, dat_cg)
dat <- do.call(rbind, dat_list)
group <- rep(1:length(dat_list), sapply(dat_list, nrow))
dat$group <- factor(group)

colors <- c("red", "blue", "green", "purple", "orange", "pink", "brown")

p <- ggplot(dat, aes(x = mb, y = randeff_sm, color = group)) + 
  geom_line(alpha=0.5) +
  labs(x = "Gemonic position", y = "Random Effect -- SMASH", title = "Comparison for different mutation types" ) + 
  scale_color_manual(values = colors,labels = c("All", "A-C", "A-T", "A-G", "C-A", "C-T", "C-G")) +
  theme_bw() + 
  theme(plot.title = element_text(hjust = 0.5))

p

```



# Comparing Smash estimates of multiple mutation types together in few regions. --- total mutation exluced (only 6 mutation types)


## 1kb

```{r echo=FALSE, message=FALSE, warning=FALSE,fig.height=6, fig.width=10}

dat_ac <- get(load("/project/xinhe/xsun/mutation_rate/1.exp_obs_gnomad/data_processed/chr22/smash_1kb_pseudo05_wholewindow_ac_constvar.rdata"))
dat_ac$mb <- dat_ac$start/1000000
dat_at <- get(load("/project/xinhe/xsun/mutation_rate/1.exp_obs_gnomad/data_processed/chr22/smash_1kb_pseudo05_wholewindow_at_constvar.rdata"))
dat_at$mb <- dat_at$start/1000000
dat_ag <- get(load("/project/xinhe/xsun/mutation_rate/1.exp_obs_gnomad/data_processed/chr22/smash_1kb_pseudo05_wholewindow_ag_constvar.rdata"))
dat_ag$mb <- dat_ag$start/1000000
dat_ca <- get(load("/project/xinhe/xsun/mutation_rate/1.exp_obs_gnomad/data_processed/chr22/smash_1kb_pseudo05_wholewindow_ca_constvar.rdata"))
dat_ca$mb <- dat_ca$start/1000000
dat_cg <- get(load("/project/xinhe/xsun/mutation_rate/1.exp_obs_gnomad/data_processed/chr22/smash_1kb_pseudo05_wholewindow_cg_constvar.rdata"))
dat_cg$mb <- dat_cg$start/1000000
dat_ct <- get(load("/project/xinhe/xsun/mutation_rate/1.exp_obs_gnomad/data_processed/chr22/smash_1kb_pseudo05_wholewindow_ct_constvar.rdata"))
dat_ct$mb <- dat_ct$start/1000000


print("9Mb")
dat_ac <- dat_ac[dat_ac$mb >31 &dat_ac$mb <40, ]
dat_at <- dat_at[dat_at$mb >31 &dat_at$mb <40, ]
dat_ag <- dat_ag[dat_ag$mb >31 &dat_ag$mb <40, ]
dat_ca <- dat_ca[dat_ca$mb >31 &dat_ca$mb <40, ]
dat_cg <- dat_cg[dat_cg$mb >31 &dat_cg$mb <40, ]
dat_ct <- dat_ct[dat_ct$mb >31 &dat_ct$mb <40, ]


dat_list <- list(dat_ac, dat_at, dat_ag, dat_ca, dat_ct, dat_cg)
dat <- do.call(rbind, dat_list)
group <- rep(1:length(dat_list), sapply(dat_list, nrow))
dat$group <- factor(group)

colors <- c("blue", "green", "purple", "orange", "pink", "brown")

p <- ggplot(dat, aes(x = mb, y = randeff_sm, color = group)) + 
  geom_line(alpha=0.5) +
  labs(x = "Gemonic position", y = "Random Effect -- SMASH", title = "Comparison for different mutation types" ) + 
  scale_color_manual(values = colors,labels = c("A-C", "A-T", "A-G", "C-A", "C-T", "C-G")) +
  theme_bw() + 
  theme(plot.title = element_text(hjust = 0.5))

p


print("5Mb")
dat_ac <- dat_ac[dat_ac$mb >31 &dat_ac$mb <36, ]
dat_at <- dat_at[dat_at$mb >31 &dat_at$mb <36, ]
dat_ag <- dat_ag[dat_ag$mb >31 &dat_ag$mb <36, ]
dat_ca <- dat_ca[dat_ca$mb >31 &dat_ca$mb <36, ]
dat_cg <- dat_cg[dat_cg$mb >31 &dat_cg$mb <36, ]
dat_ct <- dat_ct[dat_ct$mb >31 &dat_ct$mb <36, ]


dat_list <- list( dat_ac, dat_at, dat_ag, dat_ca, dat_ct, dat_cg)
dat <- do.call(rbind, dat_list)
group <- rep(1:length(dat_list), sapply(dat_list, nrow))
dat$group <- factor(group)

colors <- c("blue", "green", "purple", "orange", "pink", "brown")

p <- ggplot(dat, aes(x = mb, y = randeff_sm, color = group)) + 
  geom_line(alpha=0.5) +
  labs(x = "Gemonic position", y = "Random Effect -- SMASH", title = "Comparison for different mutation types" ) + 
  scale_color_manual(values = colors,labels = c("A-C", "A-T", "A-G", "C-A", "C-T", "C-G")) +
  theme_bw() + 
  theme(plot.title = element_text(hjust = 0.5))

p


print("1Mb")
dat_ac <- dat_ac[dat_ac$mb >31 &dat_ac$mb <32, ]
dat_at <- dat_at[dat_at$mb >31 &dat_at$mb <32, ]
dat_ag <- dat_ag[dat_ag$mb >31 &dat_ag$mb <32, ]
dat_ca <- dat_ca[dat_ca$mb >31 &dat_ca$mb <32, ]
dat_cg <- dat_cg[dat_cg$mb >31 &dat_cg$mb <32, ]
dat_ct <- dat_ct[dat_ct$mb >31 &dat_ct$mb <32, ]


dat_list <- list(dat_ac, dat_at, dat_ag, dat_ca, dat_ct, dat_cg)
dat <- do.call(rbind, dat_list)
group <- rep(1:length(dat_list), sapply(dat_list, nrow))
dat$group <- factor(group)

colors <- c("blue", "green", "purple", "orange", "pink", "brown")

p <- ggplot(dat, aes(x = mb, y = randeff_sm, color = group)) + 
  geom_line(alpha=0.5) +
  labs(x = "Gemonic position", y = "Random Effect -- SMASH", title = "Comparison for different mutation types" ) + 
  scale_color_manual(values = colors,labels = c("A-C", "A-T", "A-G", "C-A", "C-T", "C-G")) +
  theme_bw() + 
  theme(plot.title = element_text(hjust = 0.5))

p

print("0.5Mb")
dat_ac <- dat_ac[dat_ac$mb >31 &dat_ac$mb <31.5, ]
dat_at <- dat_at[dat_at$mb >31 &dat_at$mb <31.5, ]
dat_ag <- dat_ag[dat_ag$mb >31 &dat_ag$mb <31.5, ]
dat_ca <- dat_ca[dat_ca$mb >31 &dat_ca$mb <31.5, ]
dat_cg <- dat_cg[dat_cg$mb >31 &dat_cg$mb <31.5, ]
dat_ct <- dat_ct[dat_ct$mb >31 &dat_ct$mb <31.5, ]


dat_list <- list(dat_ac, dat_at, dat_ag, dat_ca, dat_ct, dat_cg)
dat <- do.call(rbind, dat_list)
group <- rep(1:length(dat_list), sapply(dat_list, nrow))
dat$group <- factor(group)

colors <- c("blue", "green", "purple", "orange", "pink", "brown")

p <- ggplot(dat, aes(x = mb, y = randeff_sm, color = group)) + 
  geom_line(alpha=0.5) +
  labs(x = "Gemonic position", y = "Random Effect -- SMASH", title = "Comparison for different mutation types" ) + 
  scale_color_manual(values = colors,labels = c("A-C", "A-T", "A-G", "C-A", "C-T", "C-G")) +
  theme_bw() + 
  theme(plot.title = element_text(hjust = 0.5))

p

```


## 10kb

```{r echo=FALSE, message=FALSE, warning=FALSE,fig.height=6, fig.width=10}


dat_ac <- get(load("/project/xinhe/xsun/mutation_rate/1.exp_obs_gnomad/data_processed/chr22/smash_10kb_pseudo05_wholewindow_ac_constvar.rdata"))
dat_ac$mb <- dat_ac$start/1000000
dat_at <- get(load("/project/xinhe/xsun/mutation_rate/1.exp_obs_gnomad/data_processed/chr22/smash_10kb_pseudo05_wholewindow_at_constvar.rdata"))
dat_at$mb <- dat_at$start/1000000
dat_ag <- get(load("/project/xinhe/xsun/mutation_rate/1.exp_obs_gnomad/data_processed/chr22/smash_10kb_pseudo05_wholewindow_ag_constvar.rdata"))
dat_ag$mb <- dat_ag$start/1000000
dat_ca <- get(load("/project/xinhe/xsun/mutation_rate/1.exp_obs_gnomad/data_processed/chr22/smash_10kb_pseudo05_wholewindow_ca_constvar.rdata"))
dat_ca$mb <- dat_ca$start/1000000
dat_cg <- get(load("/project/xinhe/xsun/mutation_rate/1.exp_obs_gnomad/data_processed/chr22/smash_10kb_pseudo05_wholewindow_cg_constvar.rdata"))
dat_cg$mb <- dat_cg$start/1000000
dat_ct <- get(load("/project/xinhe/xsun/mutation_rate/1.exp_obs_gnomad/data_processed/chr22/smash_10kb_pseudo05_wholewindow_ct_constvar.rdata"))
dat_ct$mb <- dat_ct$start/1000000


print("9Mb")
dat_ac <- dat_ac[dat_ac$mb >31 &dat_ac$mb <40, ]
dat_at <- dat_at[dat_at$mb >31 &dat_at$mb <40, ]
dat_ag <- dat_ag[dat_ag$mb >31 &dat_ag$mb <40, ]
dat_ca <- dat_ca[dat_ca$mb >31 &dat_ca$mb <40, ]
dat_cg <- dat_cg[dat_cg$mb >31 &dat_cg$mb <40, ]
dat_ct <- dat_ct[dat_ct$mb >31 &dat_ct$mb <40, ]


dat_list <- list(dat_ac, dat_at, dat_ag, dat_ca, dat_ct, dat_cg)
dat <- do.call(rbind, dat_list)
group <- rep(1:length(dat_list), sapply(dat_list, nrow))
dat$group <- factor(group)

colors <- c("blue", "green", "purple", "orange", "pink", "brown")

p <- ggplot(dat, aes(x = mb, y = randeff_sm, color = group)) + 
  geom_line(alpha=0.5) +
  labs(x = "Gemonic position", y = "Random Effect -- SMASH", title = "Comparison for different mutation types" ) + 
  scale_color_manual(values = colors,labels = c("A-C", "A-T", "A-G", "C-A", "C-T", "C-G")) +
  theme_bw() + 
  theme(plot.title = element_text(hjust = 0.5))

p


print("5Mb")
dat_ac <- dat_ac[dat_ac$mb >31 &dat_ac$mb <36, ]
dat_at <- dat_at[dat_at$mb >31 &dat_at$mb <36, ]
dat_ag <- dat_ag[dat_ag$mb >31 &dat_ag$mb <36, ]
dat_ca <- dat_ca[dat_ca$mb >31 &dat_ca$mb <36, ]
dat_cg <- dat_cg[dat_cg$mb >31 &dat_cg$mb <36, ]
dat_ct <- dat_ct[dat_ct$mb >31 &dat_ct$mb <36, ]


dat_list <- list( dat_ac, dat_at, dat_ag, dat_ca, dat_ct, dat_cg)
dat <- do.call(rbind, dat_list)
group <- rep(1:length(dat_list), sapply(dat_list, nrow))
dat$group <- factor(group)

colors <- c("blue", "green", "purple", "orange", "pink", "brown")

p <- ggplot(dat, aes(x = mb, y = randeff_sm, color = group)) + 
  geom_line(alpha=0.5) +
  labs(x = "Gemonic position", y = "Random Effect -- SMASH", title = "Comparison for different mutation types" ) + 
  scale_color_manual(values = colors,labels = c("A-C", "A-T", "A-G", "C-A", "C-T", "C-G")) +
  theme_bw() + 
  theme(plot.title = element_text(hjust = 0.5))

p


print("1Mb")
dat_ac <- dat_ac[dat_ac$mb >31 &dat_ac$mb <32, ]
dat_at <- dat_at[dat_at$mb >31 &dat_at$mb <32, ]
dat_ag <- dat_ag[dat_ag$mb >31 &dat_ag$mb <32, ]
dat_ca <- dat_ca[dat_ca$mb >31 &dat_ca$mb <32, ]
dat_cg <- dat_cg[dat_cg$mb >31 &dat_cg$mb <32, ]
dat_ct <- dat_ct[dat_ct$mb >31 &dat_ct$mb <32, ]


dat_list <- list(dat_ac, dat_at, dat_ag, dat_ca, dat_ct, dat_cg)
dat <- do.call(rbind, dat_list)
group <- rep(1:length(dat_list), sapply(dat_list, nrow))
dat$group <- factor(group)

colors <- c("blue", "green", "purple", "orange", "pink", "brown")

p <- ggplot(dat, aes(x = mb, y = randeff_sm, color = group)) + 
  geom_line(alpha=0.5) +
  labs(x = "Gemonic position", y = "Random Effect -- SMASH", title = "Comparison for different mutation types" ) + 
  scale_color_manual(values = colors,labels = c("A-C", "A-T", "A-G", "C-A", "C-T", "C-G")) +
  theme_bw() + 
  theme(plot.title = element_text(hjust = 0.5))

p

print("0.5Mb")
dat_ac <- dat_ac[dat_ac$mb >31 &dat_ac$mb <31.5, ]
dat_at <- dat_at[dat_at$mb >31 &dat_at$mb <31.5, ]
dat_ag <- dat_ag[dat_ag$mb >31 &dat_ag$mb <31.5, ]
dat_ca <- dat_ca[dat_ca$mb >31 &dat_ca$mb <31.5, ]
dat_cg <- dat_cg[dat_cg$mb >31 &dat_cg$mb <31.5, ]
dat_ct <- dat_ct[dat_ct$mb >31 &dat_ct$mb <31.5, ]


dat_list <- list(dat_ac, dat_at, dat_ag, dat_ca, dat_ct, dat_cg)
dat <- do.call(rbind, dat_list)
group <- rep(1:length(dat_list), sapply(dat_list, nrow))
dat$group <- factor(group)

colors <- c("blue", "green", "purple", "orange", "pink", "brown")

p <- ggplot(dat, aes(x = mb, y = randeff_sm, color = group)) + 
  geom_line(alpha=0.5) +
  labs(x = "Gemonic position", y = "Random Effect -- SMASH", title = "Comparison for different mutation types" ) + 
  scale_color_manual(values = colors,labels = c("A-C", "A-T", "A-G", "C-A", "C-T", "C-G")) +
  theme_bw() + 
  theme(plot.title = element_text(hjust = 0.5))

p

```

# Smash estimates of the random effects between two mutation types across all windows

## 1kb

```{r echo=FALSE, message=FALSE, warning=FALSE,fig.height=15, fig.width=25}

dat_ac <- get(load("/project/xinhe/xsun/mutation_rate/1.exp_obs_gnomad/data_processed/chr22/smash_1kb_pseudo05_wholewindow_ac_constvar.rdata"))
dat_at <- get(load("/project/xinhe/xsun/mutation_rate/1.exp_obs_gnomad/data_processed/chr22/smash_1kb_pseudo05_wholewindow_at_constvar.rdata"))
dat_ag <- get(load("/project/xinhe/xsun/mutation_rate/1.exp_obs_gnomad/data_processed/chr22/smash_1kb_pseudo05_wholewindow_ag_constvar.rdata"))
dat_ca <- get(load("/project/xinhe/xsun/mutation_rate/1.exp_obs_gnomad/data_processed/chr22/smash_1kb_pseudo05_wholewindow_ca_constvar.rdata"))
dat_cg <- get(load("/project/xinhe/xsun/mutation_rate/1.exp_obs_gnomad/data_processed/chr22/smash_1kb_pseudo05_wholewindow_cg_constvar.rdata"))
dat_ct <- get(load("/project/xinhe/xsun/mutation_rate/1.exp_obs_gnomad/data_processed/chr22/smash_1kb_pseudo05_wholewindow_ct_constvar.rdata"))


dat <- as.data.frame(cbind(dat_ac$randeff_sm,dat_ag$randeff_sm))
colnames(dat) <- c("dat1","dat2")

fit1 <- lm(dat2~ dat1 + 0, data = dat)
adj.rsq <- summary(fit1)$adj.r.squared
pval <- summary(fit1)$coefficients[,4]
p1 <- ggplot(dat, aes(x = dat1, y = dat2)) +
  geom_point(size=0.2) +
  labs(x ="Random Effects - AtoC" , y = "Random Effects - AtoG") +
  geom_smooth(method = lm, formula = y ~ x + 0, color = "red",size=0.2) +annotate("text", x = max(dat$dat1), y = max(dat$dat2), label = paste0("fitting p-value: ", round(pval, 4)), vjust = 1, hjust = 1)+
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))

dat <- as.data.frame(cbind(dat_ac$randeff_sm,dat_at$randeff_sm))
colnames(dat) <- c("dat1","dat2")

fit1 <- lm(dat2~ dat1 + 0, data = dat)
adj.rsq <- summary(fit1)$adj.r.squared
pval <- summary(fit1)$coefficients[,4]
p2 <- ggplot(dat, aes(x = dat1, y = dat2)) +
  geom_point(size=0.2) +
  labs(x ="Random Effects - AtoC" , y = "Random Effects - AtoT") +
  geom_smooth(method = lm, formula = y ~ x + 0, color = "red",size=0.2) +annotate("text", x = max(dat$dat1), y = max(dat$dat2), label = paste0("fitting p-value: ", round(pval, 4)), vjust = 1, hjust = 1)+
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))

dat <- as.data.frame(cbind(dat_ac$randeff_sm,dat_cg$randeff_sm))
colnames(dat) <- c("dat1","dat2")

fit1 <- lm(dat2~ dat1 + 0, data = dat)
adj.rsq <- summary(fit1)$adj.r.squared
pval <- summary(fit1)$coefficients[,4]
p3 <- ggplot(dat, aes(x = dat1, y = dat2)) +
  geom_point(size=0.2) +
  labs(x ="Random Effects - AtoC" , y = "Random Effects - CtoG") +
  geom_smooth(method = lm, formula = y ~ x + 0, color = "red",size=0.2) +annotate("text", x = max(dat$dat1), y = max(dat$dat2), label = paste0("fitting p-value: ", round(pval, 4)), vjust = 1, hjust = 1)+
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))

dat <- as.data.frame(cbind(dat_ac$randeff_sm,dat_ct$randeff_sm))
colnames(dat) <- c("dat1","dat2")

fit1 <- lm(dat2~ dat1 + 0, data = dat)
adj.rsq <- summary(fit1)$adj.r.squared
pval <- summary(fit1)$coefficients[,4]
p4 <- ggplot(dat, aes(x = dat1, y = dat2)) +
  geom_point(size=0.2) +
  labs(x ="Random Effects - AtoC" , y = "Random Effects - CtoT") +
  geom_smooth(method = lm, formula = y ~ x + 0, color = "red",size=0.2) +annotate("text", x = max(dat$dat1), y = max(dat$dat2), label = paste0("fitting p-value: ", round(pval, 4)), vjust = 1, hjust = 1)+
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


dat <- as.data.frame(cbind(dat_ac$randeff_sm,dat_ca$randeff_sm))
colnames(dat) <- c("dat1","dat2")

fit1 <- lm(dat2~ dat1 + 0, data = dat)
adj.rsq <- summary(fit1)$adj.r.squared
pval <- summary(fit1)$coefficients[,4]
p5 <- ggplot(dat, aes(x = dat1, y = dat2)) +
  geom_point(size=0.2) +
  labs(x ="Random Effects - AtoC" , y = "Random Effects - CtoA") +
  geom_smooth(method = lm, formula = y ~ x + 0, color = "red",size=0.2) +annotate("text", x = max(dat$dat1), y = max(dat$dat2), label = paste0("fitting p-value: ", round(pval, 4)), vjust = 1, hjust = 1)+
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


dat <- as.data.frame(cbind(dat_ag$randeff_sm,dat_at$randeff_sm))
colnames(dat) <- c("dat1","dat2")

fit1 <- lm(dat2~ dat1 + 0, data = dat)
adj.rsq <- summary(fit1)$adj.r.squared
pval <- summary(fit1)$coefficients[,4]
p6 <- ggplot(dat, aes(x = dat1, y = dat2)) +
  geom_point(size=0.2) +
  labs(x ="Random Effects - AtoG" , y = "Random Effects - AtoT") +
  geom_smooth(method = lm, formula = y ~ x + 0, color = "red",size=0.2) +annotate("text", x = max(dat$dat1), y = max(dat$dat2), label = paste0("fitting p-value: ", round(pval, 4)), vjust = 1, hjust = 1)+
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))

dat <- as.data.frame(cbind(dat_ag$randeff_sm,dat_cg$randeff_sm))
colnames(dat) <- c("dat1","dat2")

fit1 <- lm(dat2~ dat1 + 0, data = dat)
adj.rsq <- summary(fit1)$adj.r.squared
pval <- summary(fit1)$coefficients[,4]
p7 <- ggplot(dat, aes(x = dat1, y = dat2)) +
  geom_point(size=0.2) +
  labs(x ="Random Effects - AtoG" , y = "Random Effects - CtoG") +
  geom_smooth(method = lm, formula = y ~ x + 0, color = "red",size=0.2) +annotate("text", x = max(dat$dat1), y = max(dat$dat2), label = paste0("fitting p-value: ", round(pval, 4)), vjust = 1, hjust = 1)+
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))



dat <- as.data.frame(cbind(dat_ag$randeff_sm,dat_ct$randeff_sm))
colnames(dat) <- c("dat1","dat2")

fit1 <- lm(dat2~ dat1 + 0, data = dat)
adj.rsq <- summary(fit1)$adj.r.squared
pval <- summary(fit1)$coefficients[,4]
p8 <- ggplot(dat, aes(x = dat1, y = dat2)) +
  geom_point(size=0.2) +
  labs(x ="Random Effects - AtoG" , y = "Random Effects - CtoT") +
  geom_smooth(method = lm, formula = y ~ x + 0, color = "red",size=0.2) +annotate("text", x = max(dat$dat1), y = max(dat$dat2), label = paste0("fitting p-value: ", round(pval, 4)), vjust = 1, hjust = 1)+
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


dat <- as.data.frame(cbind(dat_ag$randeff_sm,dat_ca$randeff_sm))
colnames(dat) <- c("dat1","dat2")

fit1 <- lm(dat2~ dat1 + 0, data = dat)
adj.rsq <- summary(fit1)$adj.r.squared
pval <- summary(fit1)$coefficients[,4]
p9 <- ggplot(dat, aes(x = dat1, y = dat2)) +
  geom_point(size=0.2) +
  labs(x ="Random Effects - AtoG" , y = "Random Effects - CtoA") +
  geom_smooth(method = lm, formula = y ~ x + 0, color = "red",size=0.2) +annotate("text", x = max(dat$dat1), y = max(dat$dat2), label = paste0("fitting p-value: ", round(pval, 4)), vjust = 1, hjust = 1)+
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


dat <- as.data.frame(cbind(dat_at$randeff_sm,dat_cg$randeff_sm))
colnames(dat) <- c("dat1","dat2")

fit1 <- lm(dat2~ dat1 + 0, data = dat)
adj.rsq <- summary(fit1)$adj.r.squared
pval <- summary(fit1)$coefficients[,4]
p10 <- ggplot(dat, aes(x = dat1, y = dat2)) +
  geom_point(size=0.2) +
  labs(x ="Random Effects - AtoT" , y = "Random Effects - CtoG") +
  geom_smooth(method = lm, formula = y ~ x + 0, color = "red",size=0.2) +annotate("text", x = max(dat$dat1), y = max(dat$dat2), label = paste0("fitting p-value: ", round(pval, 4)), vjust = 1, hjust = 1)+
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


dat <- as.data.frame(cbind(dat_at$randeff_sm,dat_ct$randeff_sm))
colnames(dat) <- c("dat1","dat2")

fit1 <- lm(dat2~ dat1 + 0, data = dat)
adj.rsq <- summary(fit1)$adj.r.squared
pval <- summary(fit1)$coefficients[,4]
p11 <- ggplot(dat, aes(x = dat1, y = dat2)) +
  geom_point(size=0.2) +
  labs(x ="Random Effects - AtoT" , y = "Random Effects - CtoT") +
  geom_smooth(method = lm, formula = y ~ x + 0, color = "red",size=0.2) +annotate("text", x = max(dat$dat1), y = max(dat$dat2), label = paste0("fitting p-value: ", round(pval, 4)), vjust = 1, hjust = 1)+
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))

dat <- as.data.frame(cbind(dat_at$randeff_sm,dat_ca$randeff_sm))
colnames(dat) <- c("dat1","dat2")

fit1 <- lm(dat2~ dat1 + 0, data = dat)
adj.rsq <- summary(fit1)$adj.r.squared
pval <- summary(fit1)$coefficients[,4]
p12 <- ggplot(dat, aes(x = dat1, y = dat2)) +
  geom_point(size=0.2) +
  labs(x ="Random Effects - AtoT" , y = "Random Effects - CtoA") +
  geom_smooth(method = lm, formula = y ~ x + 0, color = "red",size=0.2) +annotate("text", x = max(dat$dat1), y = max(dat$dat2), label = paste0("fitting p-value: ", round(pval, 4)), vjust = 1, hjust = 1)+
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))

dat <- as.data.frame(cbind(dat_cg$randeff_sm,dat_ct$randeff_sm))
colnames(dat) <- c("dat1","dat2")

fit1 <- lm(dat2~ dat1 + 0, data = dat)
adj.rsq <- summary(fit1)$adj.r.squared
pval <- summary(fit1)$coefficients[,4]
p13 <- ggplot(dat, aes(x = dat1, y = dat2)) +
  geom_point(size=0.2) +
  labs(x ="Random Effects - CtoG" , y = "Random Effects - CtoT") +
  geom_smooth(method = lm, formula = y ~ x + 0, color = "red",size=0.2) +annotate("text", x = max(dat$dat1), y = max(dat$dat2), label = paste0("fitting p-value: ", round(pval, 4)), vjust = 1, hjust = 1)+
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


dat <- as.data.frame(cbind(dat_cg$randeff_sm,dat_ca$randeff_sm))
colnames(dat) <- c("dat1","dat2")

fit1 <- lm(dat2~ dat1 + 0, data = dat)
adj.rsq <- summary(fit1)$adj.r.squared
pval <- summary(fit1)$coefficients[,4]
p14 <- ggplot(dat, aes(x = dat1, y = dat2)) +
  geom_point(size=0.2) +
  labs(x ="Random Effects - CtoG" , y = "Random Effects - CtoA") +
  geom_smooth(method = lm, formula = y ~ x + 0, color = "red",size=0.2) +annotate("text", x = max(dat$dat1), y = max(dat$dat2), label = paste0("fitting p-value: ", round(pval, 4)), vjust = 1, hjust = 1)+
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


dat <- as.data.frame(cbind(dat_ct$randeff_sm,dat_ca$randeff_sm))
colnames(dat) <- c("dat1","dat2")

fit1 <- lm(dat2~ dat1 + 0, data = dat)
adj.rsq <- summary(fit1)$adj.r.squared
pval <- summary(fit1)$coefficients[,4]
p15 <- ggplot(dat, aes(x = dat1, y = dat2)) +
  geom_point(size=0.2) +
  labs(x ="Random Effects - Ctot" , y = "Random Effects - CtoA") +
  geom_smooth(method = lm, formula = y ~ x + 0, color = "red",size=0.2) +annotate("text", x = max(dat$dat1), y = max(dat$dat2), label = paste0("fitting p-value: ", round(pval, 4)), vjust = 1, hjust = 1)+
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


grid.arrange(p1, p2,p3,p4, p5,p6,p7, p8,p9,p10, p11,p12,p13,p14, p15,ncol=5)
```


## 10kb

```{r echo=FALSE, message=FALSE, warning=FALSE,fig.height=15, fig.width=25}

dat_ac <- get(load("/project/xinhe/xsun/mutation_rate/1.exp_obs_gnomad/data_processed/chr22/smash_10kb_pseudo05_wholewindow_ac_constvar.rdata"))
dat_at <- get(load("/project/xinhe/xsun/mutation_rate/1.exp_obs_gnomad/data_processed/chr22/smash_10kb_pseudo05_wholewindow_at_constvar.rdata"))
dat_ag <- get(load("/project/xinhe/xsun/mutation_rate/1.exp_obs_gnomad/data_processed/chr22/smash_10kb_pseudo05_wholewindow_ag_constvar.rdata"))
dat_ca <- get(load("/project/xinhe/xsun/mutation_rate/1.exp_obs_gnomad/data_processed/chr22/smash_10kb_pseudo05_wholewindow_ca_constvar.rdata"))
dat_cg <- get(load("/project/xinhe/xsun/mutation_rate/1.exp_obs_gnomad/data_processed/chr22/smash_10kb_pseudo05_wholewindow_cg_constvar.rdata"))
dat_ct <- get(load("/project/xinhe/xsun/mutation_rate/1.exp_obs_gnomad/data_processed/chr22/smash_10kb_pseudo05_wholewindow_ct_constvar.rdata"))


dat <- as.data.frame(cbind(dat_ac$randeff_sm,dat_ag$randeff_sm))
colnames(dat) <- c("dat1","dat2")

fit1 <- lm(dat2~ dat1 + 0, data = dat)
adj.rsq <- summary(fit1)$adj.r.squared
pval <- summary(fit1)$coefficients[,4]
p1 <- ggplot(dat, aes(x = dat1, y = dat2)) +
  geom_point(size=0.2) +
  labs(x ="Random Effects - AtoC" , y = "Random Effects - AtoG") +
  geom_smooth(method = lm, formula = y ~ x + 0, color = "red",size=0.2) +annotate("text", x = max(dat$dat1), y = max(dat$dat2), label = paste0("fitting p-value: ", round(pval, 4)), vjust = 1, hjust = 1)+
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))

dat <- as.data.frame(cbind(dat_ac$randeff_sm,dat_at$randeff_sm))
colnames(dat) <- c("dat1","dat2")

fit1 <- lm(dat2~ dat1 + 0, data = dat)
adj.rsq <- summary(fit1)$adj.r.squared
pval <- summary(fit1)$coefficients[,4]
p2 <- ggplot(dat, aes(x = dat1, y = dat2)) +
  geom_point(size=0.2) +
  labs(x ="Random Effects - AtoC" , y = "Random Effects - AtoT") +
  geom_smooth(method = lm, formula = y ~ x + 0, color = "red",size=0.2) +annotate("text", x = max(dat$dat1), y = max(dat$dat2), label = paste0("fitting p-value: ", round(pval, 4)), vjust = 1, hjust = 1)+
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))

dat <- as.data.frame(cbind(dat_ac$randeff_sm,dat_cg$randeff_sm))
colnames(dat) <- c("dat1","dat2")

fit1 <- lm(dat2~ dat1 + 0, data = dat)
adj.rsq <- summary(fit1)$adj.r.squared
pval <- summary(fit1)$coefficients[,4]
p3 <- ggplot(dat, aes(x = dat1, y = dat2)) +
  geom_point(size=0.2) +
  labs(x ="Random Effects - AtoC" , y = "Random Effects - CtoG") +
  geom_smooth(method = lm, formula = y ~ x + 0, color = "red",size=0.2) +annotate("text", x = max(dat$dat1), y = max(dat$dat2), label = paste0("fitting p-value: ", round(pval, 4)), vjust = 1, hjust = 1)+
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))

dat <- as.data.frame(cbind(dat_ac$randeff_sm,dat_ct$randeff_sm))
colnames(dat) <- c("dat1","dat2")

fit1 <- lm(dat2~ dat1 + 0, data = dat)
adj.rsq <- summary(fit1)$adj.r.squared
pval <- summary(fit1)$coefficients[,4]
p4 <- ggplot(dat, aes(x = dat1, y = dat2)) +
  geom_point(size=0.2) +
  labs(x ="Random Effects - AtoC" , y = "Random Effects - CtoT") +
  geom_smooth(method = lm, formula = y ~ x + 0, color = "red",size=0.2) +annotate("text", x = max(dat$dat1), y = max(dat$dat2), label = paste0("fitting p-value: ", round(pval, 4)), vjust = 1, hjust = 1)+
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


dat <- as.data.frame(cbind(dat_ac$randeff_sm,dat_ca$randeff_sm))
colnames(dat) <- c("dat1","dat2")

fit1 <- lm(dat2~ dat1 + 0, data = dat)
adj.rsq <- summary(fit1)$adj.r.squared
pval <- summary(fit1)$coefficients[,4]
p5 <- ggplot(dat, aes(x = dat1, y = dat2)) +
  geom_point(size=0.2) +
  labs(x ="Random Effects - AtoC" , y = "Random Effects - CtoA") +
  geom_smooth(method = lm, formula = y ~ x + 0, color = "red",size=0.2) +annotate("text", x = max(dat$dat1), y = max(dat$dat2), label = paste0("fitting p-value: ", round(pval, 4)), vjust = 1, hjust = 1)+
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


dat <- as.data.frame(cbind(dat_ag$randeff_sm,dat_at$randeff_sm))
colnames(dat) <- c("dat1","dat2")

fit1 <- lm(dat2~ dat1 + 0, data = dat)
adj.rsq <- summary(fit1)$adj.r.squared
pval <- summary(fit1)$coefficients[,4]
p6 <- ggplot(dat, aes(x = dat1, y = dat2)) +
  geom_point(size=0.2) +
  labs(x ="Random Effects - AtoG" , y = "Random Effects - AtoT") +
  geom_smooth(method = lm, formula = y ~ x + 0, color = "red",size=0.2) +annotate("text", x = max(dat$dat1), y = max(dat$dat2), label = paste0("fitting p-value: ", round(pval, 4)), vjust = 1, hjust = 1)+
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))

dat <- as.data.frame(cbind(dat_ag$randeff_sm,dat_cg$randeff_sm))
colnames(dat) <- c("dat1","dat2")

fit1 <- lm(dat2~ dat1 + 0, data = dat)
adj.rsq <- summary(fit1)$adj.r.squared
pval <- summary(fit1)$coefficients[,4]
p7 <- ggplot(dat, aes(x = dat1, y = dat2)) +
  geom_point(size=0.2) +
  labs(x ="Random Effects - AtoG" , y = "Random Effects - CtoG") +
  geom_smooth(method = lm, formula = y ~ x + 0, color = "red",size=0.2) +annotate("text", x = max(dat$dat1), y = max(dat$dat2), label = paste0("fitting p-value: ", round(pval, 4)), vjust = 1, hjust = 1)+
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))



dat <- as.data.frame(cbind(dat_ag$randeff_sm,dat_ct$randeff_sm))
colnames(dat) <- c("dat1","dat2")

fit1 <- lm(dat2~ dat1 + 0, data = dat)
adj.rsq <- summary(fit1)$adj.r.squared
pval <- summary(fit1)$coefficients[,4]
p8 <- ggplot(dat, aes(x = dat1, y = dat2)) +
  geom_point(size=0.2) +
  labs(x ="Random Effects - AtoG" , y = "Random Effects - CtoT") +
  geom_smooth(method = lm, formula = y ~ x + 0, color = "red",size=0.2) +annotate("text", x = max(dat$dat1), y = max(dat$dat2), label = paste0("fitting p-value: ", round(pval, 4)), vjust = 1, hjust = 1)+
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


dat <- as.data.frame(cbind(dat_ag$randeff_sm,dat_ca$randeff_sm))
colnames(dat) <- c("dat1","dat2")

fit1 <- lm(dat2~ dat1 + 0, data = dat)
adj.rsq <- summary(fit1)$adj.r.squared
pval <- summary(fit1)$coefficients[,4]
p9 <- ggplot(dat, aes(x = dat1, y = dat2)) +
  geom_point(size=0.2) +
  labs(x ="Random Effects - AtoG" , y = "Random Effects - CtoA") +
  geom_smooth(method = lm, formula = y ~ x + 0, color = "red",size=0.2) +annotate("text", x = max(dat$dat1), y = max(dat$dat2), label = paste0("fitting p-value: ", round(pval, 4)), vjust = 1, hjust = 1)+
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


dat <- as.data.frame(cbind(dat_at$randeff_sm,dat_cg$randeff_sm))
colnames(dat) <- c("dat1","dat2")

fit1 <- lm(dat2~ dat1 + 0, data = dat)
adj.rsq <- summary(fit1)$adj.r.squared
pval <- summary(fit1)$coefficients[,4]
p10 <- ggplot(dat, aes(x = dat1, y = dat2)) +
  geom_point(size=0.2) +
  labs(x ="Random Effects - AtoT" , y = "Random Effects - CtoG") +
  geom_smooth(method = lm, formula = y ~ x + 0, color = "red",size=0.2) +annotate("text", x = max(dat$dat1), y = max(dat$dat2), label = paste0("fitting p-value: ", round(pval, 4)), vjust = 1, hjust = 1)+
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


dat <- as.data.frame(cbind(dat_at$randeff_sm,dat_ct$randeff_sm))
colnames(dat) <- c("dat1","dat2")

fit1 <- lm(dat2~ dat1 + 0, data = dat)
adj.rsq <- summary(fit1)$adj.r.squared
pval <- summary(fit1)$coefficients[,4]
p11 <- ggplot(dat, aes(x = dat1, y = dat2)) +
  geom_point(size=0.2) +
  labs(x ="Random Effects - AtoT" , y = "Random Effects - CtoT") +
  geom_smooth(method = lm, formula = y ~ x + 0, color = "red",size=0.2) +annotate("text", x = max(dat$dat1), y = max(dat$dat2), label = paste0("fitting p-value: ", round(pval, 4)), vjust = 1, hjust = 1)+
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))

dat <- as.data.frame(cbind(dat_at$randeff_sm,dat_ca$randeff_sm))
colnames(dat) <- c("dat1","dat2")

fit1 <- lm(dat2~ dat1 + 0, data = dat)
adj.rsq <- summary(fit1)$adj.r.squared
pval <- summary(fit1)$coefficients[,4]
p12 <- ggplot(dat, aes(x = dat1, y = dat2)) +
  geom_point(size=0.2) +
  labs(x ="Random Effects - AtoT" , y = "Random Effects - CtoA") +
  geom_smooth(method = lm, formula = y ~ x + 0, color = "red",size=0.2) +annotate("text", x = max(dat$dat1), y = max(dat$dat2), label = paste0("fitting p-value: ", round(pval, 4)), vjust = 1, hjust = 1)+
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))

dat <- as.data.frame(cbind(dat_cg$randeff_sm,dat_ct$randeff_sm))
colnames(dat) <- c("dat1","dat2")

fit1 <- lm(dat2~ dat1 + 0, data = dat)
adj.rsq <- summary(fit1)$adj.r.squared
pval <- summary(fit1)$coefficients[,4]
p13 <- ggplot(dat, aes(x = dat1, y = dat2)) +
  geom_point(size=0.2) +
  labs(x ="Random Effects - CtoG" , y = "Random Effects - CtoT") +
  geom_smooth(method = lm, formula = y ~ x + 0, color = "red",size=0.2) +annotate("text", x = max(dat$dat1), y = max(dat$dat2), label = paste0("fitting p-value: ", round(pval, 4)), vjust = 1, hjust = 1)+
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


dat <- as.data.frame(cbind(dat_cg$randeff_sm,dat_ca$randeff_sm))
colnames(dat) <- c("dat1","dat2")

fit1 <- lm(dat2~ dat1 + 0, data = dat)
adj.rsq <- summary(fit1)$adj.r.squared
pval <- summary(fit1)$coefficients[,4]
p14 <- ggplot(dat, aes(x = dat1, y = dat2)) +
  geom_point(size=0.2) +
  labs(x ="Random Effects - CtoG" , y = "Random Effects - CtoA") +
  geom_smooth(method = lm, formula = y ~ x + 0, color = "red",size=0.2) +annotate("text", x = max(dat$dat1), y = max(dat$dat2), label = paste0("fitting p-value: ", round(pval, 4)), vjust = 1, hjust = 1)+
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


dat <- as.data.frame(cbind(dat_ct$randeff_sm,dat_ca$randeff_sm))
colnames(dat) <- c("dat1","dat2")

fit1 <- lm(dat2~ dat1 + 0, data = dat)
adj.rsq <- summary(fit1)$adj.r.squared
pval <- summary(fit1)$coefficients[,4]
p15 <- ggplot(dat, aes(x = dat1, y = dat2)) +
  geom_point(size=0.2) +
  labs(x ="Random Effects - Ctot" , y = "Random Effects - CtoA") +
  geom_smooth(method = lm, formula = y ~ x + 0, color = "red",size=0.2) +annotate("text", x = max(dat$dat1), y = max(dat$dat2), label = paste0("fitting p-value: ", round(pval, 4)), vjust = 1, hjust = 1)+
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


grid.arrange(p1, p2,p3,p4, p5,p6,p7, p8,p9,p10, p11,p12,p13,p14, p15,ncol=5)
```